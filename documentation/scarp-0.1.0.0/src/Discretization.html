<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Discretization</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">LinearAlgebra</span><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Parallel</span><span class="hs-operator">.</span><span class="hs-identifier">Strategies</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">LinearAlgebra</span><span class="hs-operator">.</span><span class="hs-identifier">Sparse</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Sv</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Binary</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">B</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">transpose</span><span class="hs-special">,</span><span class="hs-identifier hs-var">sort</span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="Helpers.html"><span class="hs-identifier">Helpers</span></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="CollectiveAxiom.html"><span class="hs-identifier">CollectiveAxiom</span></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Encode.html"><span class="hs-identifier">Encode</span></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-identifier">nPeriods</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- this is global now, not on lower level</span><span>
</span><a name="line-16"></a><a name="nPeriods"><a href="Discretization.html#nPeriods"><span class="hs-identifier">nPeriods</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-identifier">classifyTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Helpers.html#HChoice3"><span class="hs-identifier hs-type">HChoice3</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Helpers.html#HChoice3"><span class="hs-identifier hs-type">HChoice3</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-19"></a><a name="classifyTree"><a href="Discretization.html#classifyTree"><span class="hs-identifier">classifyTree</span></a></a><span> </span><a name="local-6989586621679085331"><a href="#local-6989586621679085331"><span class="hs-identifier">pathsAndIdcs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="#local-6989586621679085332"><span class="hs-identifier hs-var">classifier</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679085331"><span class="hs-identifier hs-var">pathsAndIdcs</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">using</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">parListChunk</span><span> </span><span class="hs-number">1024</span><span> </span><span class="hs-identifier hs-var">rdeepseq</span><span> </span><span>
</span><a name="line-20"></a><span>	</span><span class="hs-keyword">where</span><span>
</span><a name="line-21"></a><span>		</span><span class="hs-identifier">classifier</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">idx</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679085332"><a href="#local-6989586621679085332"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">idx</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkCollectiveRationality</span><span> </span><a href="CollectiveAxiom.html#checkCollectiveRationality"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">checkPathIndividualRationality</span><span> </span><a href="CollectiveAxiom.html#checkPathIndividualRationality"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-identifier">cpp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Helpers.html#HChoice3"><span class="hs-identifier hs-type">HChoice3</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-24"></a><a name="cpp"><a href="Discretization.html#cpp"><span class="hs-identifier">cpp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sort</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Helpers.html#tuplify"><span class="hs-identifier hs-var">tuplify</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Encode.html#choicesPerComposition"><span class="hs-identifier hs-var">choicesPerComposition</span></a><span> </span><a href="Discretization.html#nPeriods"><span class="hs-identifier hs-var">nPeriods</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Helpers.html#HChoice3"><span class="hs-identifier hs-type">HChoice3</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- map (map tuplify) (choicesPerPeriod nPeriods) :: [[HChoice3]] -- OLD</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-identifier">pickleTypeSpace</span><span>	</span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">AssocMatrix</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><a name="pickleTypeSpace"><a href="Discretization.html#pickleTypeSpace"><span class="hs-identifier">pickleTypeSpace</span></a></a><span> </span><a name="local-6989586621679085335"><a href="#local-6989586621679085335"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679085336"><a href="#local-6989586621679085336"><span class="hs-identifier">mA</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">B</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">writeFile</span><span> </span><a href="#local-6989586621679085335"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">encode</span><span> </span><a href="#local-6989586621679085336"><span class="hs-identifier hs-var">mA</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-identifier">unpickleTypeSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">AssocMatrix</span><span>
</span><a name="line-30"></a><a name="unpickleTypeSpace"><a href="Discretization.html#unpickleTypeSpace"><span class="hs-identifier">unpickleTypeSpace</span></a></a><span> </span><a name="local-6989586621679085337"><a href="#local-6989586621679085337"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-31"></a><span>	</span><span class="hs-identifier">mAUni</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a name="local-6989586621679085338"><a href="#local-6989586621679085338"><span class="hs-identifier">B</span><span class="hs-operator">.</span></a></a><span class="hs-identifier">readFile</span><span> </span><span class="hs-identifier hs-var">f</span><span>
</span><a name="line-32"></a><span>	</span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">decode</span><span> </span><span class="hs-identifier hs-var">mAUni</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">AssocMatrix</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-identifier">getChoicePiResampler</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Helpers.html#HChoice3"><span class="hs-identifier hs-type">HChoice3</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Helpers.html#HChoice3"><span class="hs-identifier hs-type">HChoice3</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SparseVector</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-35"></a><a name="getChoicePiResampler"><a href="Discretization.html#getChoicePiResampler"><span class="hs-identifier">getChoicePiResampler</span></a></a><span> </span><a name="local-6989586621679085339"><a href="#local-6989586621679085339"><span class="hs-identifier">choicesPerPeriod</span></a></a><span> </span><a name="local-6989586621679085340"><a href="#local-6989586621679085340"><span class="hs-identifier">idcs</span></a></a><span> </span><a name="local-6989586621679085341"><a href="#local-6989586621679085341"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Sv</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">sparseList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Control</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Monad</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679085344"><span class="hs-identifier hs-var">rel</span></a><span> </span><a href="#local-6989586621679085342"><span class="hs-identifier hs-var">vPiN</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-36"></a><span>	</span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span>		</span><span class="hs-identifier">vPiN</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">snd</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">zipWith</span><span> </span><span class="hs-identifier">histogram</span><span> </span><span class="hs-identifier">reshuffledCs</span><span> </span><span class="hs-identifier">choicesPerPeriod</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>		</span><span class="hs-identifier">reshuffledCs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679085343"><a href="#local-6989586621679085343"><span class="hs-identifier">multi</span></a></a><span> </span><span class="hs-identifier">ls</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a name="local-6989586621679085345"><a href="#local-6989586621679085345"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-operator">!!</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span class="hs-glyph">&lt;-</span><span class="hs-identifier">is</span><span class="hs-special">]</span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">zipWith</span><span> </span><span class="hs-identifier">multi</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">transpose</span><span> </span><a href="#local-6989586621679085345"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">idcs</span><span> </span><span>
</span><a name="line-39"></a><span>		</span><span class="hs-identifier">rel</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679085344"><a href="#local-6989586621679085344"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-identifier hs-var">xs</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">xs</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-identifier">reshuffleChoices</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Helpers.html#HChoice3"><span class="hs-identifier hs-type">HChoice3</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Helpers.html#HChoice3"><span class="hs-identifier hs-type">HChoice3</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-42"></a><a name="reshuffleChoices"><a href="Discretization.html#reshuffleChoices"><span class="hs-identifier">reshuffleChoices</span></a></a><span> </span><a name="local-6989586621679085351"><a href="#local-6989586621679085351"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679085352"><a href="#local-6989586621679085352"><span class="hs-identifier">idcs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679085353"><a href="#local-6989586621679085353"><span class="hs-identifier">multi</span></a></a><span> </span><a name="local-6989586621679085354"><a href="#local-6989586621679085354"><span class="hs-identifier">ls</span></a></a><span> </span><a name="local-6989586621679085355"><a href="#local-6989586621679085355"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679085354"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679085356"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679085356"><a href="#local-6989586621679085356"><span class="hs-identifier">i</span></a></a><span class="hs-glyph">&lt;-</span><a href="#local-6989586621679085355"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">]</span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="#local-6989586621679085353"><span class="hs-identifier hs-var">multi</span></a><span> </span><a href="#local-6989586621679085351"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679085352"><span class="hs-identifier hs-var">idcs</span></a><span>  </span><span class="hs-comment">-- before: transpose cs, transpose outside zipWith</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-identifier">getPiFromChoices</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="Helpers.html#HChoice3"><span class="hs-identifier hs-type">HChoice3</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SparseVector</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-45"></a><a name="getPiFromChoices"><a href="Discretization.html#getPiFromChoices"><span class="hs-identifier">getPiFromChoices</span></a></a><span> </span><a name="local-6989586621679085357"><a href="#local-6989586621679085357"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Sv</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">sparseList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Control</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Monad</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679085359"><span class="hs-identifier hs-var">rel</span></a><span> </span><a href="#local-6989586621679085358"><span class="hs-identifier hs-var">vPiN</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-46"></a><span>	</span><span class="hs-keyword">where</span><span>
</span><a name="line-47"></a><span>		</span><span class="hs-identifier">vPiN</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">snd</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">zipWith</span><span> </span><span class="hs-identifier">safeHistogram</span><span> </span><a href="Helpers.html#safeHistogram"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="Helpers.html#safeHistogram"><span class="hs-identifier hs-var">cpp</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>		</span><span class="hs-identifier">rel</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679085359"><a href="#local-6989586621679085359"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-identifier hs-var">xs</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">xs</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">-- check consistncy of pi and A</span><span>
</span><a name="line-51"></a><span class="hs-comment">-- filter ((&gt;0) . snd . snd) $ zip [1..] $ join $ zipWith histogram (transpose $ [map head cpp]) cpp -- or last</span><span>
</span><a name="line-52"></a><span class="hs-comment">-- asAssocMatrix' nPeriods ncpp [[1,1,1]]  -- or ncpp</span><span>
</span><a name="line-53"></a><span>	</span><span>
</span><a name="line-54"></a><span>	</span><span class="hs-comment">-- generateChoices</span><span>
</span><a name="line-55"></a><span>	</span><span class="hs-comment">--let cpp = map (sort . map tuplify) (choicesPerComposition nPeriods) :: [[HChoice3]] -- NEW</span><span>
</span><a name="line-56"></a><span>	</span><span class="hs-comment">--let ncpp = map length cpp</span><span>
</span><a name="line-57"></a><span>	</span><span class="hs-comment">--let choiceset = combinations nPeriods  -- OLD</span><span>
</span><a name="line-58"></a><span>	</span><span class="hs-comment">--let paths = map (map tuplify) choiceset :: [[HChoice3]] -- OLD</span><span>
</span><a name="line-59"></a><span>	</span><span class="hs-comment">--let paths = sequence cpp -- NEW</span><span>
</span><a name="line-60"></a><span>	</span><span class="hs-comment">--let classifiedPaths = classifyTree $ zip paths (replicateM nPeriods [0..(head ncpp-1)]) -- OLD</span><span>
</span><a name="line-61"></a><span>	</span><span class="hs-comment">--let classifiedPaths = classifyTree $ zip paths (mapM (\t -&gt; [1..t]) ncpp) -- NEW</span><span>
</span><a name="line-62"></a></pre></body></html>