<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Warshall</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><a href="Helpers.html"><span class="hs-identifier">Helpers</span></a><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Matrix</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-identifier">warshall</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Helpers.html#BinRel"><span class="hs-identifier hs-type">BinRel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-7"></a><a name="warshall"><a href="Warshall.html#warshall"><span class="hs-identifier">warshall</span></a></a><span> </span><a name="local-6989586621679083667"><a href="#local-6989586621679083667"><span class="hs-identifier">start</span></a></a><span> </span><a name="local-6989586621679083668"><a href="#local-6989586621679083668"><span class="hs-identifier">end</span></a></a><span> </span><a name="local-6989586621679083669"><a href="#local-6989586621679083669"><span class="hs-identifier">graph</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679083670"><span class="hs-identifier hs-var">dist</span></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679083670"><a href="#local-6989586621679083670"><span class="hs-identifier">dist</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Warshall.html#adjacent"><span class="hs-identifier hs-var">adjacent</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083667"><span class="hs-identifier hs-var">start</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679083668"><span class="hs-identifier hs-var">end</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">nrows</span><span> </span><a href="#local-6989586621679083669"><span class="hs-identifier hs-var">graph</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083669"><span class="hs-identifier hs-var">graph</span></a><span>
</span><a name="line-9"></a><span>        </span><span class="hs-comment">-- route = constructPath (start, end, length graph) graph</span><span>
</span><a name="line-10"></a><span>        </span><span>
</span><a name="line-11"></a><span class="hs-identifier">adjacent</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Helpers.html#BinRel"><span class="hs-identifier hs-type">BinRel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span>
</span><a name="line-12"></a><a name="adjacent"><a href="Warshall.html#adjacent"><span class="hs-identifier">adjacent</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679083671"><a href="#local-6989586621679083671"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679083672"><a href="#local-6989586621679083672"><span class="hs-identifier">j</span></a></a><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679083673"><a href="#local-6989586621679083673"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679083673"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083671"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679083672"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Transition value from graph</span><span>
</span><a name="line-13"></a><span class="hs-identifier">adjacent</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679083674"><a href="#local-6989586621679083674"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679083675"><a href="#local-6989586621679083675"><span class="hs-identifier">j</span></a></a><span class="hs-special">,</span><a name="local-6989586621679083676"><a href="#local-6989586621679083676"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679083677"><a href="#local-6989586621679083677"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Warshall.html#adjacent"><span class="hs-identifier hs-var">adjacent</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083674"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679083675"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">,</span><a href="#local-6989586621679083676"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083677"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="Warshall.html#adjacent"><span class="hs-identifier hs-var">adjacent</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083674"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679083676"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679083676"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083677"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Warshall.html#adjacent"><span class="hs-identifier hs-var">adjacent</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083676"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679083675"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">,</span><a href="#local-6989586621679083676"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083677"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-identifier">constructPath</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Helpers.html#BinRel"><span class="hs-identifier hs-type">BinRel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-16"></a><a name="constructPath"><a href="Warshall.html#constructPath"><span class="hs-identifier">constructPath</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-17"></a><span class="hs-identifier">constructPath</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679083678"><a href="#local-6989586621679083678"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679083679"><a href="#local-6989586621679083679"><span class="hs-identifier">j</span></a></a><span class="hs-special">,</span><a name="local-6989586621679083680"><a href="#local-6989586621679083680"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679083681"><a href="#local-6989586621679083681"><span class="hs-identifier">g</span></a></a><span>
</span><a name="line-18"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679083682"><span class="hs-identifier hs-var">direct</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679083683"><span class="hs-identifier hs-var">step</span></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Warshall.html#constructPath"><span class="hs-identifier hs-var">constructPath</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083678"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679083679"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">,</span><a href="#local-6989586621679083680"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083681"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span>  </span><a href="Warshall.html#constructPath"><span class="hs-identifier hs-var">constructPath</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083678"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679083680"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679083680"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083681"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679083680"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Warshall.html#constructPath"><span class="hs-identifier hs-var">constructPath</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083680"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679083679"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">,</span><a href="#local-6989586621679083680"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083681"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-20"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679083682"><a href="#local-6989586621679083682"><span class="hs-identifier">direct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Warshall.html#adjacent"><span class="hs-identifier hs-var">adjacent</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083678"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679083679"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">,</span><a href="#local-6989586621679083680"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083681"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-21"></a><span>        </span><a name="local-6989586621679083683"><a href="#local-6989586621679083683"><span class="hs-identifier">step</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Warshall.html#adjacent"><span class="hs-identifier hs-var">adjacent</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083678"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679083680"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679083680"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083681"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Warshall.html#adjacent"><span class="hs-identifier hs-var">adjacent</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083680"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679083679"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">,</span><a href="#local-6989586621679083680"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083681"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-identifier">testAdjacencyMatrix</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-24"></a><a name="testAdjacencyMatrix"><a href="Warshall.html#testAdjacencyMatrix"><span class="hs-identifier">testAdjacencyMatrix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-identifier">transitiveClosure</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Helpers.html#BinRel"><span class="hs-identifier hs-type">BinRel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Helpers.html#BinRel"><span class="hs-identifier hs-type">BinRel</span></a><span>
</span><a name="line-27"></a><a name="transitiveClosure"><a href="Warshall.html#transitiveClosure"><span class="hs-identifier">transitiveClosure</span></a></a><span> </span><a name="local-6989586621679083684"><a href="#local-6989586621679083684"><span class="hs-identifier">adj</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><span class="hs-identifier hs-var">matrix</span><span> </span><a href="#local-6989586621679083685"><span class="hs-identifier hs-var">dim</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679083686"><a href="#local-6989586621679083686"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679083687"><a href="#local-6989586621679083687"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Warshall.html#warshall"><span class="hs-identifier hs-var">warshall</span></a><span> </span><a href="#local-6989586621679083686"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679083687"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679083684"><span class="hs-identifier hs-var">adj</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-28"></a><span>	</span><span class="hs-keyword">where</span><span>
</span><a name="line-29"></a><span>		</span><span class="hs-identifier">dim</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nrows</span><span> </span><span class="hs-identifier">adj</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ncols</span><span> </span><span class="hs-identifier">adj</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a></pre></body></html>